<div class="bg-white pb-6 rounded-b-lg">
  <magma-shared-title></magma-shared-title>
</div>

<section class="bg-white rounded-md mt-2">
  <nz-tabset>
    <nz-tab nzTitle="Dados Gerais">
      <form nz-form [formGroup]="form" nzLayout="vertical" (ngSubmit)="salvar()" class="mt-2">
        <div class="px-4 py-3">
          <div nz-row nzGutter="24">
            <div nz-col nzXs="24" nzSm="24" nzMd="18" nzLg="18" nzXl="18">
              <nz-form-item>
                <nz-form-label nzRequired>Nome</nz-form-label>
                <nz-form-control>
                  <input nz-input formControlName="nome" placeholder="Nome do curso" />
                </nz-form-control>
              </nz-form-item>
            </div>

            <div nz-col nzXs="24" nzSm="12" nzMd="6" nzLg="6" nzXl="6">
              <nz-form-item>
                <nz-form-label nzRequired>Duração (Semestres)</nz-form-label>
                <nz-form-control>
                  <nz-input-number formControlName="duracaoSemestres" nzPlaceHolder="Semestres" [nzMin]="1" [nzMax]="20" class="w-full"></nz-input-number>
                </nz-form-control>
              </nz-form-item>
            </div>
          </div>
        </div>
        <div class="flex justify-end px-4 py-4 space-x-2 bg-blue-50 rounded-b-lg border-t">
          <button type="submit" nz-button nzType="primary" [nzLoading]="salvandoCurso">
            {{ cursoId ? 'Salvar' : 'Cadastrar' }}
          </button>
        </div>
      </form>
    </nz-tab>

    @if(cursoId) {
      <nz-tab nzTitle="Disciplinas">
        <div class="px-4 py-3">
          <disciplina-listar [cursoId]="cursoId" [isTabelaRelacionada]="true"></disciplina-listar>
        </div>
      </nz-tab>

      <nz-tab nzTitle="Alunos">
        <div class="px-4 py-3">
          <aluno-listar [cursoId]="cursoId" [isTabelaRelacionada]="true"></aluno-listar>
        </div>
      </nz-tab>
    }
  </nz-tabset>
</section>

@if(cursoId && curso) {
  <section class="bg-white rounded-md mt-4">
    <div class="px-4 py-3 border-b">
      <h3 class="text-lg font-semibold text-gray-800">Resumo</h3>
    </div>
    <div class="px-4 py-4">
      @if(carregandoResumo) {
        <div class="flex items-center justify-center py-8">
          <nz-spin nzSize="large"></nz-spin>
        </div>
      } @else if(resumo?.resumo) {
        <div class="bg-gray-50 rounded-lg p-4">
          <div class="mb-3">
            <span class="text-sm font-medium text-gray-600">Curso:</span>
            <span class="ml-2 text-sm text-gray-800">{{ resumo.nomeCurso }}</span>
          </div>
          <div class="text-gray-700 leading-relaxed">
            {{ resumo.resumo }}
          </div>
        </div>
      } @else {
        <div class="text-center py-8 text-gray-500">
          <nz-empty nzNotFoundImage="simple" nzNotFoundContent="Nenhum resumo disponível para este curso"></nz-empty>
        </div>
      }
    </div>
  </section>
}
